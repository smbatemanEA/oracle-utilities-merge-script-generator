
/*------------------------------------------------------------------------------------------------------------------------------

	 Author:  Sheldon Bateman (sheldon@gravityconsultingus.com)
	Created:  2025/04/22
	 Status:  POC draft. R&D ONLY; Not optimized.
	Purpose:  DDL for Table INGEST_GDE_JSON_COLLECTION in 19c
			  Target table from ATP's live feed process. Live feed consumes JSON file from Object Storage and
			  writes the JSON record as a binary object (OSON) collection.
--------------------------------------------------------------------------------------------------------------------------------
Change History

 YYYY/MM/DD:  Name & Email 
	(* / + / -) Change/Add/Remove. A comprehensive description of the changes.

-------------------------------------------------------------------------------------------------------------------------------*/



  CREATE TABLE "ADMIN"."INGEST_GDE_JSON_COLLECTION" 
   (	"ID" VARCHAR2(255 BYTE) COLLATE "USING_NLS_COMP", 
	"CREATED_ON" TIMESTAMP (6) DEFAULT sys_extract_utc(SYSTIMESTAMP), 
	"LAST_MODIFIED" TIMESTAMP (6) DEFAULT sys_extract_utc(SYSTIMESTAMP), 
	"VERSION" VARCHAR2(255 BYTE) COLLATE "USING_NLS_COMP", 
	"JSON_DOCUMENT" BLOB
   )  DEFAULT COLLATION "USING_NLS_COMP" SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 10 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "DATA" 
 LOB ("JSON_DOCUMENT") STORE AS SECUREFILE (
  TABLESPACE "DATA" ENABLE STORAGE IN ROW CHUNK 8192
  CACHE  NOCOMPRESS  KEEP_DUPLICATES 
  STORAGE(INITIAL 106496 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)) ;

	
   COMMENT ON COLUMN "ADMIN"."INGEST_GDE_JSON_COLLECTION"."ID" 				IS 'UUID generated by the data feed';
   COMMENT ON COLUMN "ADMIN"."INGEST_GDE_JSON_COLLECTION"."CREATED_ON" 		IS 'Timestamp generated by the data feed';
   COMMENT ON COLUMN "ADMIN"."INGEST_GDE_JSON_COLLECTION"."LAST_MODIFIED" 	IS 'Timestamp generated by the data feed';
   COMMENT ON COLUMN "ADMIN"."INGEST_GDE_JSON_COLLECTION"."VERSION" 		IS 'UUID generated by the data feed';
   COMMENT ON COLUMN "ADMIN"."INGEST_GDE_JSON_COLLECTION"."JSON_DOCUMENT" 	IS 'JSON payload in OSON format';

  
--------------------------------------------------------
--  DDL for Index CM_IDXSMB0123
--------------------------------------------------------

  CREATE UNIQUE INDEX "ADMIN"."CM_IDXSMB0123" ON "ADMIN"."INGEST_GDE_JSON_COLLECTION" ("ID") 
  PCTFREE 10 INITRANS 20 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "DATA" ;
--------------------------------------------------------
--  Constraints for Table INGEST_GDE_JSON_COLLECTION
--------------------------------------------------------

  ALTER TABLE "ADMIN"."INGEST_GDE_JSON_COLLECTION" MODIFY ("ID" NOT NULL ENABLE);
  ALTER TABLE "ADMIN"."INGEST_GDE_JSON_COLLECTION" MODIFY ("CREATED_ON" NOT NULL ENABLE);
  ALTER TABLE "ADMIN"."INGEST_GDE_JSON_COLLECTION" MODIFY ("LAST_MODIFIED" NOT NULL ENABLE);
  ALTER TABLE "ADMIN"."INGEST_GDE_JSON_COLLECTION" MODIFY ("VERSION" NOT NULL ENABLE);
  ALTER TABLE "ADMIN"."INGEST_GDE_JSON_COLLECTION" ADD CHECK ("JSON_DOCUMENT" is json format oson (size limit 32m)) ENABLE;
  ALTER TABLE "ADMIN"."INGEST_GDE_JSON_COLLECTION" ADD PRIMARY KEY ("ID")
  USING INDEX PCTFREE 10 INITRANS 20 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "DATA"  ENABLE;
